// Requerimos el paquete
var nodemailer = require('nodemailer');

const emailCtrl = {};

// Creamos el objeto de transporte
var transporter = nodemailer.createTransport({
    host: 'smtp.gmail.com',
    port: 465,
    auth: {
        user: 'yagari2017@gmail.com',
        pass: 'YAGARIINC2017!'
    }
});

emailCtrl.sendEmail = async (req, res, next) => {
    var mailOptions = {
        from: 'yagari2017@gmail.com',
        to: 'ricardor495@gmail.com',
        subject: 'Notificacion de firmas electronicas',
        //text: mensaje,
        html: ' :D ' // '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>[SUBJECT]</title><style type="text/css">body {padding-top: 0 !important;padding-bottom: 0 !important;padding-top: 0 !important;padding-bottom: 0 !important;margin: 0 !important;width: 100% !important;-webkit-text-size-adjust: 100% !important;-ms-text-size-adjust: 100% !important;-webkit-font-smoothing: antialiased !important;}@media only screen and (max-width:480px) {table[class="MainContainer"],td[class="cell"] {width: 100% !important;height: auto !important;}td[class="specbundle"] {width: 100% !important;float: left !important;font-size: 13px !important;line-height: 17px !important;display: block !important;}td[class="specbundle1"] {width: 100% !important;float: left !important;font-size: 13px !important;line-height: 17px !important;display: block !important;padding-bottom: 20px !important;}td[class="specbundle2"] {width: 90% !important;float: left !important;font-size: 14px !important;line-height: 18px !important;display: block !important;padding-left: 5% !important;padding-right: 5% !important;}td[class="specbundle3"] {width: 90% !important;float: left !important;font-size: 14px !important;line-height: 18px !important;display: block !important;padding-left: 5% !important;padding-right: 5% !important;padding-bottom: 20px !important;text-align: center !important;}td[class="specbundle4"] {width: 100% !important;float: left !important;font-size: 13px !important;line-height: 17px !important;display: block !important;padding-bottom: 20px !important;text-align: center !important;}td[class="spechide"] {display: none !important;}img[class="banner"] {width: 100% !important;height: auto !important;}td[class="left_pad"] {padding-left: 15px !important;padding-right: 15px !important;}}@media only screen and (max-width:540px) {table[class="MainContainer"],td[class="cell"] {width: 100% !important;height: auto !important;}td[class="specbundle"] {width: 100% !important;float: left !important;font-size: 13px !important;line-height: 17px !important;display: block !important;}td[class="specbundle1"] {width: 100% !important;float: left !important;font-size: 13px !important;line-height: 17px !important;display: block !important;padding-bottom: 20px !important;}td[class="specbundle2"] {width: 90% !important;float: left !important;font-size: 14px !important;line-height: 18px !important;display: block !important;padding-left: 5% !important;padding-right: 5% !important;}td[class="specbundle3"] {width: 90% !important;float: left !important;font-size: 14px !important;line-height: 18px !important;display: block !important;padding-left: 5% !important;padding-right: 5% !important;padding-bottom: 20px !important;text-align: center !important;}td[class="specbundle4"] {width: 100% !important;float: left !important;font-size: 13px !important;line-height: 17px !important;display: block !important;padding-bottom: 20px !important;text-align: center !important;}td[class="spechide"] {display: none !important;}img[class="banner"] {width: 100% !important;height: auto !important;}td[class="left_pad"] {padding-left: 15px !important;padding-right: 15px !important;}.font {font-size: 15px !important;line-height: 19px !important;}}</style><script type="colorScheme" class="swatch active">{"name":"Default","bgBody":"F6F6F6","link":"69C374","color":"999999","bgItem":"ffffff","title":"555555"}</script></head><body paddingwidth="0" paddingheight="0" style="padding-top: 0; padding-bottom: 0; padding-top: 0; padding-bottom: 0; background-repeat: repeat; width: 100% !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; -webkit-font-smoothing: antialiased;"offset="0" toppadding="0" leftpadding="0"><table width="100%" border="0" cellspacing="0" cellpadding="0" class="tableContent bgBody" align="center"style="font-family:helvetica, sans-serif;"><!--  =========================== The header ===========================  --><tbody><tr><td height="25" bgcolor="#43474A" colspan="3"></td></tr><tr><tbody><tr><td valign="top" class="spechide"><table width="100%" border="0" cellspacing="0" cellpadding="0"><tbody><tr><td height="130" bgcolor="#43474A">&nbsp;</td></tr><tr><td>&nbsp;</td></tr></tbody></table></td><td valign="top" width="600"><table width="600" border="0" cellspacing="0" cellpadding="0" align="center" class="MainContainer" bgcolor="#ffffff"><tbody><!--  =========================== The body ===========================  --><tr><td class="movableContentContainer"><div class="movableContent" style="border: 0px; padding-top: 0px; position: relative;"><table width="100%" border="0" cellspacing="0" cellpadding="0" align="center"valign="top"><tr><td bgcolor="#43474A" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" valign="top"><tr><td align="right" valign="top"></td></tr></table></td></tr></table></div><div class="movableContent" style="border: 0px; padding-top: 0px; position: relative;"><table width="100%" border="0" cellspacing="0" cellpadding="0" align="center"valign="top"><tr><td height="25" bgcolor="#43474A"></td></tr><tr><td height="5" bgcolor="#69C374"></td></tr><tr><td height="40" class="bgItem"></td></tr><tr><td><table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" valign="top" class="bgItem"><tr><td width="70"></td><td align="center" width="530"><div class="contentEditableContainer contentTextEditable"><div class="contentEditable"style="font-size:32px;color:#555555;font-weight:normal;"><h2 style="font-size:32px;">GUERRA CHAVEZ Y ASOC.</h2></div></div></td></tr><tr><td colspan="3" height="22"></td></tr><tr><td width="70"></td><td align="center" width="530"><div class="contentEditableContainer contentTextEditable"><div class="contentEditable"style="font-size:13px;color:#99A1A6;line-height:19px;"><p>Este correo es una alarma del sistema de firmas electronicas.</p></div><table><tr><td>Nombre del cliente:</td></tr><tr><td>Fecha de vencimiento:</td></tr><tr><td>RFC:</td></tr><tr></tr></table></div></td><td width='70'></td></tr></table></td></tr></table></div><div class="movableContent"style="border: 0px; padding-top: 0px; position: relative;"><table width="100%" border="0" cellspacing="0" cellpadding="0" align="center"valign="top"><tr><td height="10" bgcolor="#69C374"></td></tr></table></div></td></tr></tbody></table></td><td valign="top" class="spechide"><table width="100%" border="0" cellspacing="0" cellpadding="0"><tbody><tr><td height="130" bgcolor="#43474A">&nbsp;</td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></body></html>',
    };

    transporter.sendMail(mailOptions, function(error, info){
        if (error) {
          console.log('Error: ' + error);
        } else {
          console.log('Correo enviado');
        }
    });
};

module.exports = emailCtrl;
